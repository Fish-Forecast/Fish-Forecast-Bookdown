<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Fisheries Catch Forecasting</title>
  <meta name="description" content="This book will show you how to model and forecast annual and seasonal fisheries catches using R and its time-series analysis functions and packages. Forecasting using time-varying regression, ARIMA (Box-Jenkins) models, and expoential smoothing models is demonstrated using real catch time series. The entire process from data evaluation and diagnostics, model fitting, model selection and forecast evaluation is shown. The focus of the book is on univariate time series (annual or seasonal), however multivariate regression with autocorrelated errors and multivariate autoregressive models (MAR) are covered briefly. For multivariate autoregressive models and multivariate autoregressive state-space models for fisheries and environmental sciences, see Holmes, Ward and Scheuerell (2018).">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="Fisheries Catch Forecasting" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="images/cover.png" />
  <meta property="og:description" content="This book will show you how to model and forecast annual and seasonal fisheries catches using R and its time-series analysis functions and packages. Forecasting using time-varying regression, ARIMA (Box-Jenkins) models, and expoential smoothing models is demonstrated using real catch time series. The entire process from data evaluation and diagnostics, model fitting, model selection and forecast evaluation is shown. The focus of the book is on univariate time series (annual or seasonal), however multivariate regression with autocorrelated errors and multivariate autoregressive models (MAR) are covered briefly. For multivariate autoregressive models and multivariate autoregressive state-space models for fisheries and environmental sciences, see Holmes, Ward and Scheuerell (2018)." />
  <meta name="github-repo" content="fish-forecast/Fish-Forecast-Bookdown/" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Fisheries Catch Forecasting" />
  
  <meta name="twitter:description" content="This book will show you how to model and forecast annual and seasonal fisheries catches using R and its time-series analysis functions and packages. Forecasting using time-varying regression, ARIMA (Box-Jenkins) models, and expoential smoothing models is demonstrated using real catch time series. The entire process from data evaluation and diagnostics, model fitting, model selection and forecast evaluation is shown. The focus of the book is on univariate time series (annual or seasonal), however multivariate regression with autocorrelated errors and multivariate autoregressive models (MAR) are covered briefly. For multivariate autoregressive models and multivariate autoregressive state-space models for fisheries and environmental sciences, see Holmes, Ward and Scheuerell (2018)." />
  <meta name="twitter:image" content="images/cover.png" />

<meta name="author" content="Elizabeth Holmes">


<meta name="date" content="2018-10-11">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="4-2-simple-ets.html">
<link rel="next" href="5-testing-forecast-accuracy.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<link rel="shortcut icon" href="favicon.ico" type="image/x-icon">


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./index.html"><img src="./images/fish-forecast.jpg" width=50></a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="1-introduction.html"><a href="1-introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="1-1-stergiou-and-christou-1996.html"><a href="1-1-stergiou-and-christou-1996.html"><i class="fa fa-check"></i><b>1.1</b> Stergiou and Christou 1996</a><ul>
<li class="chapter" data-level="1.1.1" data-path="1-1-stergiou-and-christou-1996.html"><a href="1-1-stergiou-and-christou-1996.html#hellenic-landings-data"><i class="fa fa-check"></i><b>1.1.1</b> Hellenic landings data</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="1-2-the-landings-data-landings-rdata.html"><a href="1-2-the-landings-data-landings-rdata.html"><i class="fa fa-check"></i><b>1.2</b> The landings data, landings.RData</a></li>
<li class="chapter" data-level="1.3" data-path="1-3-ts-objects.html"><a href="1-3-ts-objects.html"><i class="fa fa-check"></i><b>1.3</b> ts objects</a><ul>
<li class="chapter" data-level="1.3.1" data-path="1-3-ts-objects.html"><a href="1-3-ts-objects.html#ts-function"><i class="fa fa-check"></i><b>1.3.1</b> <code>ts()</code> function</a></li>
<li class="chapter" data-level="1.3.2" data-path="1-3-ts-objects.html"><a href="1-3-ts-objects.html#ggplot-and-ts-objects"><i class="fa fa-check"></i><b>1.3.2</b> ggplot and ts objects</a></li>
<li class="chapter" data-level="1.3.3" data-path="1-3-ts-objects.html"><a href="1-3-ts-objects.html#plotting-using-a-data-frame"><i class="fa fa-check"></i><b>1.3.3</b> Plotting using a data frame</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="1-4-packages.html"><a href="1-4-packages.html"><i class="fa fa-check"></i><b>1.4</b> Packages</a></li>
<li class="chapter" data-level="1.5" data-path="1-5-references.html"><a href="1-5-references.html"><i class="fa fa-check"></i><b>1.5</b> References</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="2-time-varying-regression.html"><a href="2-time-varying-regression.html"><i class="fa fa-check"></i><b>2</b> Time-varying regression</a><ul>
<li class="chapter" data-level="2.1" data-path="2-1-fitting-time-varying-regressions.html"><a href="2-1-fitting-time-varying-regressions.html"><i class="fa fa-check"></i><b>2.1</b> Fitting time-varying regressions</a><ul>
<li class="chapter" data-level="2.1.1" data-path="2-1-fitting-time-varying-regressions.html"><a href="2-1-fitting-time-varying-regressions.html#orthogonal-polynomials"><i class="fa fa-check"></i><b>2.1.1</b> Orthogonal polynomials</a></li>
<li class="chapter" data-level="2.1.2" data-path="2-1-fitting-time-varying-regressions.html"><a href="2-1-fitting-time-varying-regressions.html#residual-diagnostics"><i class="fa fa-check"></i><b>2.1.2</b> Residual diagnostics</a></li>
<li class="chapter" data-level="2.1.3" data-path="2-1-fitting-time-varying-regressions.html"><a href="2-1-fitting-time-varying-regressions.html#compare-to-stergiou-and-christou"><i class="fa fa-check"></i><b>2.1.3</b> Compare to Stergiou and Christou</a></li>
<li class="chapter" data-level="2.1.4" data-path="2-1-fitting-time-varying-regressions.html"><a href="2-1-fitting-time-varying-regressions.html#summary"><i class="fa fa-check"></i><b>2.1.4</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="2-2-forecasting-with-a-time-varying-regression-model.html"><a href="2-2-forecasting-with-a-time-varying-regression-model.html"><i class="fa fa-check"></i><b>2.2</b> Forecasting with a time-varying regression model</a><ul>
<li class="chapter" data-level="2.2.1" data-path="2-2-forecasting-with-a-time-varying-regression-model.html"><a href="2-2-forecasting-with-a-time-varying-regression-model.html#the-forecast-package"><i class="fa fa-check"></i><b>2.2.1</b> The forecast package</a></li>
<li class="chapter" data-level="2.2.2" data-path="2-2-forecasting-with-a-time-varying-regression-model.html"><a href="2-2-forecasting-with-a-time-varying-regression-model.html#summary-1"><i class="fa fa-check"></i><b>2.2.2</b> Summary</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="3-arima-models.html"><a href="3-arima-models.html"><i class="fa fa-check"></i><b>3</b> ARIMA Models</a><ul>
<li class="chapter" data-level="3.1" data-path="3-1-overview.html"><a href="3-1-overview.html"><i class="fa fa-check"></i><b>3.1</b> Overview</a><ul>
<li class="chapter" data-level="3.1.1" data-path="3-1-overview.html"><a href="3-1-overview.html#components-of-an-arima-model"><i class="fa fa-check"></i><b>3.1.1</b> Components of an ARIMA model</a></li>
<li class="chapter" data-level="3.1.2" data-path="3-1-overview.html"><a href="3-1-overview.html#box-jenkins-method"><i class="fa fa-check"></i><b>3.1.2</b> Box-Jenkins Method</a></li>
<li class="chapter" data-level="3.1.3" data-path="3-1-overview.html"><a href="3-1-overview.html#acf-and-pacf-functions"><i class="fa fa-check"></i><b>3.1.3</b> ACF and PACF functions</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="3-2-stationarity.html"><a href="3-2-stationarity.html"><i class="fa fa-check"></i><b>3.2</b> Stationarity</a><ul>
<li class="chapter" data-level="3.2.1" data-path="3-2-stationarity.html"><a href="3-2-stationarity.html#definition"><i class="fa fa-check"></i><b>3.2.1</b> Definition</a></li>
<li class="chapter" data-level="3.2.2" data-path="3-2-stationarity.html"><a href="3-2-stationarity.html#non-stationarity"><i class="fa fa-check"></i><b>3.2.2</b> Non-stationarity</a></li>
<li class="chapter" data-level="3.2.3" data-path="3-2-stationarity.html"><a href="3-2-stationarity.html#stationarity-tests"><i class="fa fa-check"></i><b>3.2.3</b> Stationarity tests</a></li>
<li class="chapter" data-level="3.2.4" data-path="3-2-stationarity.html"><a href="3-2-stationarity.html#differencing-the-data"><i class="fa fa-check"></i><b>3.2.4</b> Differencing the data</a></li>
<li class="chapter" data-level="3.2.5" data-path="3-2-stationarity.html"><a href="3-2-stationarity.html#summary-2"><i class="fa fa-check"></i><b>3.2.5</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="3-3-model-structure.html"><a href="3-3-model-structure.html"><i class="fa fa-check"></i><b>3.3</b> Model Structure</a><ul>
<li class="chapter" data-level="3.3.1" data-path="3-3-model-structure.html"><a href="3-3-model-structure.html#ar-and-ma-lags"><i class="fa fa-check"></i><b>3.3.1</b> AR and MA lags</a></li>
<li class="chapter" data-level="3.3.2" data-path="3-3-model-structure.html"><a href="3-3-model-structure.html#model-order"><i class="fa fa-check"></i><b>3.3.2</b> Model order</a></li>
<li class="chapter" data-level="3.3.3" data-path="3-3-model-structure.html"><a href="3-3-model-structure.html#choosing-the-ar-and-ma-levels"><i class="fa fa-check"></i><b>3.3.3</b> Choosing the AR and MA levels</a></li>
<li class="chapter" data-level="3.3.4" data-path="3-3-model-structure.html"><a href="3-3-model-structure.html#trace-true"><i class="fa fa-check"></i><b>3.3.4</b> Trace = TRUE</a></li>
<li class="chapter" data-level="3.3.5" data-path="3-3-model-structure.html"><a href="3-3-model-structure.html#stepwisefalse"><i class="fa fa-check"></i><b>3.3.5</b> stepwise=FALSE</a></li>
<li class="chapter" data-level="3.3.6" data-path="3-3-model-structure.html"><a href="3-3-model-structure.html#summary-3"><i class="fa fa-check"></i><b>3.3.6</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="3-4-fitting-arima-models.html"><a href="3-4-fitting-arima-models.html"><i class="fa fa-check"></i><b>3.4</b> Fitting ARIMA Models</a><ul>
<li class="chapter" data-level="3.4.1" data-path="3-4-fitting-arima-models.html"><a href="3-4-fitting-arima-models.html#fitting-with-auto.arima"><i class="fa fa-check"></i><b>3.4.1</b> Fitting with <code>auto.arima()</code></a></li>
<li class="chapter" data-level="3.4.2" data-path="3-4-fitting-arima-models.html"><a href="3-4-fitting-arima-models.html#outputting-the-models-tested"><i class="fa fa-check"></i><b>3.4.2</b> Outputting the models tested</a></li>
<li class="chapter" data-level="3.4.3" data-path="3-4-fitting-arima-models.html"><a href="3-4-fitting-arima-models.html#repeat-with-the-sardine-data"><i class="fa fa-check"></i><b>3.4.3</b> Repeat with the sardine data</a></li>
<li class="chapter" data-level="3.4.4" data-path="3-4-fitting-arima-models.html"><a href="3-4-fitting-arima-models.html#missing-values"><i class="fa fa-check"></i><b>3.4.4</b> Missing values</a></li>
<li class="chapter" data-level="3.4.5" data-path="3-4-fitting-arima-models.html"><a href="3-4-fitting-arima-models.html#fit-a-specific-arima-model"><i class="fa fa-check"></i><b>3.4.5</b> Fit a specific ARIMA model</a></li>
<li class="chapter" data-level="3.4.6" data-path="3-4-fitting-arima-models.html"><a href="3-4-fitting-arima-models.html#model-checking"><i class="fa fa-check"></i><b>3.4.6</b> Model Checking</a></li>
<li class="chapter" data-level="3.4.7" data-path="3-4-fitting-arima-models.html"><a href="3-4-fitting-arima-models.html#workflow-for-non-seasonal-data"><i class="fa fa-check"></i><b>3.4.7</b> Workflow for non-seasonal data</a></li>
<li class="chapter" data-level="3.4.8" data-path="3-4-fitting-arima-models.html"><a href="3-4-fitting-arima-models.html#stepwise-vs-exhaustive-model-selection"><i class="fa fa-check"></i><b>3.4.8</b> Stepwise vs exhaustive model selection</a></li>
<li class="chapter" data-level="3.4.9" data-path="3-4-fitting-arima-models.html"><a href="3-4-fitting-arima-models.html#summary-4"><i class="fa fa-check"></i><b>3.4.9</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="3-5-forecasting.html"><a href="3-5-forecasting.html"><i class="fa fa-check"></i><b>3.5</b> Forecasting</a><ul>
<li class="chapter" data-level="3.5.1" data-path="3-5-forecasting.html"><a href="3-5-forecasting.html#forecasting-with-forecast"><i class="fa fa-check"></i><b>3.5.1</b> Forecasting with <code>forecast()</code></a></li>
<li class="chapter" data-level="3.5.2" data-path="3-5-forecasting.html"><a href="3-5-forecasting.html#missing-values-1"><i class="fa fa-check"></i><b>3.5.2</b> Missing values</a></li>
<li class="chapter" data-level="3.5.3" data-path="3-5-forecasting.html"><a href="3-5-forecasting.html#null-forecast-models"><i class="fa fa-check"></i><b>3.5.3</b> Null forecast models</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="4-exponential-smoothing-models.html"><a href="4-exponential-smoothing-models.html"><i class="fa fa-check"></i><b>4</b> Exponential Smoothing Models</a><ul>
<li class="chapter" data-level="4.1" data-path="4-1-naive-forecast.html"><a href="4-1-naive-forecast.html"><i class="fa fa-check"></i><b>4.1</b> Naive forecast</a></li>
<li class="chapter" data-level="4.2" data-path="4-2-simple-ets.html"><a href="4-2-simple-ets.html"><i class="fa fa-check"></i><b>4.2</b> Simple ETS</a></li>
<li class="chapter" data-level="4.3" data-path="4-3-fitting-with-ets.html"><a href="4-3-fitting-with-ets.html"><i class="fa fa-check"></i><b>4.3</b> Fitting with <code>ets()</code></a><ul>
<li class="chapter" data-level="4.3.1" data-path="4-3-fitting-with-ets.html"><a href="4-3-fitting-with-ets.html#exponential-smoothing-with-no-trend"><i class="fa fa-check"></i><b>4.3.1</b> Exponential smoothing with no trend</a></li>
<li class="chapter" data-level="4.3.2" data-path="4-3-fitting-with-ets.html"><a href="4-3-fitting-with-ets.html#the-weighting-function"><i class="fa fa-check"></i><b>4.3.2</b> The weighting function</a></li>
<li class="chapter" data-level="4.3.3" data-path="4-3-fitting-with-ets.html"><a href="4-3-fitting-with-ets.html#produce-forecast-using-a-previous-fit"><i class="fa fa-check"></i><b>4.3.3</b> Produce forecast using a previous fit</a></li>
<li class="chapter" data-level="4.3.4" data-path="4-3-fitting-with-ets.html"><a href="4-3-fitting-with-ets.html#naive-model-with-drift"><i class="fa fa-check"></i><b>4.3.4</b> Naive model with drift</a></li>
<li class="chapter" data-level="4.3.5" data-path="4-3-fitting-with-ets.html"><a href="4-3-fitting-with-ets.html#exponential-smoothing-model-with-trend"><i class="fa fa-check"></i><b>4.3.5</b> Exponential smoothing model with trend</a></li>
<li class="chapter" data-level="4.3.6" data-path="4-3-fitting-with-ets.html"><a href="4-3-fitting-with-ets.html#naive-model-with-trend"><i class="fa fa-check"></i><b>4.3.6</b> Naive model with trend</a></li>
<li class="chapter" data-level="4.3.7" data-path="4-3-fitting-with-ets.html"><a href="4-3-fitting-with-ets.html#exponential-smoothing-model-with-trend-1"><i class="fa fa-check"></i><b>4.3.7</b> Exponential smoothing model with trend</a></li>
<li class="chapter" data-level="4.3.8" data-path="4-3-fitting-with-ets.html"><a href="4-3-fitting-with-ets.html#decomposing-your-model-fit"><i class="fa fa-check"></i><b>4.3.8</b> Decomposing your model fit</a></li>
<li class="chapter" data-level="4.3.9" data-path="4-3-fitting-with-ets.html"><a href="4-3-fitting-with-ets.html#forecast-performance"><i class="fa fa-check"></i><b>4.3.9</b> Forecast performance</a></li>
<li class="chapter" data-level="4.3.10" data-path="4-3-fitting-with-ets.html"><a href="4-3-fitting-with-ets.html#test-forecast-performance"><i class="fa fa-check"></i><b>4.3.10</b> Test forecast performance</a></li>
<li class="chapter" data-level="4.3.11" data-path="4-3-fitting-with-ets.html"><a href="4-3-fitting-with-ets.html#testing-a-specific-ets-model"><i class="fa fa-check"></i><b>4.3.11</b> Testing a specific ets model</a></li>
<li class="chapter" data-level="4.3.12" data-path="4-3-fitting-with-ets.html"><a href="4-3-fitting-with-ets.html#forecast-accuracy-metrics"><i class="fa fa-check"></i><b>4.3.12</b> Forecast accuracy metrics</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="5-testing-forecast-accuracy.html"><a href="5-testing-forecast-accuracy.html"><i class="fa fa-check"></i><b>5</b> Testing forecast accuracy</a><ul>
<li class="chapter" data-level="5.1" data-path="5-1-measures-of-forecast-accuracy.html"><a href="5-1-measures-of-forecast-accuracy.html"><i class="fa fa-check"></i><b>5.1</b> Measures of forecast accuracy</a><ul>
<li class="chapter" data-level="5.1.1" data-path="5-1-measures-of-forecast-accuracy.html"><a href="5-1-measures-of-forecast-accuracy.html#metrics"><i class="fa fa-check"></i><b>5.1.1</b> Metrics</a></li>
<li class="chapter" data-level="5.1.2" data-path="5-1-measures-of-forecast-accuracy.html"><a href="5-1-measures-of-forecast-accuracy.html#test-multiple-models"><i class="fa fa-check"></i><b>5.1.2</b> Test multiple models</a></li>
<li class="chapter" data-level="5.1.3" data-path="5-1-measures-of-forecast-accuracy.html"><a href="5-1-measures-of-forecast-accuracy.html#cross-validation"><i class="fa fa-check"></i><b>5.1.3</b> Cross-Validation</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="5-2-testing-multiple-models.html"><a href="5-2-testing-multiple-models.html"><i class="fa fa-check"></i><b>5.2</b> Testing multiple models</a><ul>
<li class="chapter" data-level="5.2.1" data-path="5-2-testing-multiple-models.html"><a href="5-2-testing-multiple-models.html#example-candidate-model-set-for-anchovy"><i class="fa fa-check"></i><b>5.2.1</b> Example candidate model set for anchovy</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="6-covariates.html"><a href="6-covariates.html"><i class="fa fa-check"></i><b>6</b> Covariates</a><ul>
<li class="chapter" data-level="6.1" data-path="6-1-multivariate-linear-regression-with-arma-errors.html"><a href="6-1-multivariate-linear-regression-with-arma-errors.html"><i class="fa fa-check"></i><b>6.1</b> Multivariate linear regression with ARMA errors</a><ul>
<li class="chapter" data-level="6.1.1" data-path="6-1-multivariate-linear-regression-with-arma-errors.html"><a href="6-1-multivariate-linear-regression-with-arma-errors.html#example-anchovy"><i class="fa fa-check"></i><b>6.1.1</b> Example: anchovy</a></li>
<li class="chapter" data-level="6.1.2" data-path="6-1-multivariate-linear-regression-with-arma-errors.html"><a href="6-1-multivariate-linear-regression-with-arma-errors.html#mreg-of-first-or-second-differences"><i class="fa fa-check"></i><b>6.1.2</b> MREG of first or second differences</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="7-seasonality.html"><a href="7-seasonality.html"><i class="fa fa-check"></i><b>7</b> Seasonality</a><ul>
<li class="chapter" data-level="7.0.1" data-path="7-seasonality.html"><a href="7-seasonality.html#load-the-chinook-salmon-data-set"><i class="fa fa-check"></i><b>7.0.1</b> Load the chinook salmon data set</a></li>
<li class="chapter" data-level="7.0.2" data-path="7-seasonality.html"><a href="7-seasonality.html#plot-seasonal-data"><i class="fa fa-check"></i><b>7.0.2</b> Plot seasonal data</a></li>
<li class="chapter" data-level="7.1" data-path="7-1-seasonal-exponential-smoothing-model.html"><a href="7-1-seasonal-exponential-smoothing-model.html"><i class="fa fa-check"></i><b>7.1</b> Seasonal Exponential Smoothing Model</a><ul>
<li class="chapter" data-level="7.1.1" data-path="7-1-seasonal-exponential-smoothing-model.html"><a href="7-1-seasonal-exponential-smoothing-model.html#force-seasonality-to-evolve-more"><i class="fa fa-check"></i><b>7.1.1</b> Force seasonality to evolve more</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="7-2-seasonal-arima-model.html"><a href="7-2-seasonal-arima-model.html"><i class="fa fa-check"></i><b>7.2</b> Seasonal ARIMA model</a></li>
<li class="chapter" data-level="7.3" data-path="7-3-missing-values-2.html"><a href="7-3-missing-values-2.html"><i class="fa fa-check"></i><b>7.3</b> Missing values</a></li>
<li class="chapter" data-level="7.4" data-path="7-4-forecast-evaluation.html"><a href="7-4-forecast-evaluation.html"><i class="fa fa-check"></i><b>7.4</b> Forecast evaluation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references-1.html"><a href="references-1.html"><i class="fa fa-check"></i>References</a></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="A-inputting-data.html"><a href="A-inputting-data.html"><i class="fa fa-check"></i><b>A</b> Inputting data</a><ul>
<li class="chapter" data-level="" data-path="A-inputting-data.html"><a href="A-inputting-data.html#one-response-variable"><i class="fa fa-check"></i>one response variable</a></li>
<li class="chapter" data-level="" data-path="A-inputting-data.html"><a href="A-inputting-data.html#many-response-variables"><i class="fa fa-check"></i>Many response variables</a></li>
<li class="chapter" data-level="" data-path="A-inputting-data.html"><a href="A-inputting-data.html#many-response-variables-two-time-variables"><i class="fa fa-check"></i>Many response variables, two time variables</a></li>
<li class="chapter" data-level="" data-path="A-inputting-data.html"><a href="A-inputting-data.html#one-response-variable-multiple-explanatory-variables"><i class="fa fa-check"></i>One response variable, multiple explanatory variables</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="B-downloading-icoads-covariates.html"><a href="B-downloading-icoads-covariates.html"><i class="fa fa-check"></i><b>B</b> Downloading ICOADS covariates</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Fisheries Catch Forecasting</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="fitting-with-ets" class="section level2">
<h2><span class="header-section-number">4.3</span> Fitting with <code>ets()</code></h2>
<p>The forecast package will fit a wide variety of exponential smoothing models. The main fitting function is <code>ets()</code>:</p>
<pre><code>ets(y, model = &quot;ZZZ&quot;, &lt; + many other arguments &gt;)</code></pre>
<ul>
<li><p>y : your data. A time series of responses.</p></li>
<li><p>model: what type of exponential smoothing model.</p></li>
</ul>
<p>We are going to use <code>ets()</code> to fit three simple types of exponential smoothing models:</p>
<table>
<thead>
<tr class="header">
<th>model</th>
<th>“ZZZ”</th>
<th>alternate function</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>exponential smoothing no trend</td>
<td>“ANN”</td>
<td><code>ses()</code></td>
</tr>
<tr class="even">
<td>exponential smoothing with trend</td>
<td>“AAN”</td>
<td><code>holt()</code></td>
</tr>
<tr class="odd">
<td>exponential smoothing choose trend</td>
<td>“AZN”</td>
<td>NA</td>
</tr>
</tbody>
</table>
<p>The alternate function does exactly the same fitting. It is just a ‘shortcut’.</p>
<hr />
<div id="exponential-smoothing-with-no-trend" class="section level3">
<h3><span class="header-section-number">4.3.1</span> Exponential smoothing with no trend</h3>
<p>This is like the naive model that just uses the last value to make the forecast, but instead of only using the last value it will use values farther in the past also. The weighting fall off exponentially.</p>
<p>Load the data and forecast package.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">load</span>(<span class="st">&quot;landings.RData&quot;</span>)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">fit &lt;-<span class="st"> </span>forecast<span class="op">::</span><span class="kw">ets</span>(anchovy87ts, <span class="dt">model=</span><span class="st">&quot;ANN&quot;</span>)
fr &lt;-<span class="st"> </span>forecast<span class="op">::</span><span class="kw">forecast</span>(fit, <span class="dt">h=</span><span class="dv">5</span>)</code></pre>
<hr />
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(fr)</code></pre>
<p><img src="Fish-Forecast_files/figure-html/unnamed-chunk-32-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Look at the estimates</p>
<pre class="sourceCode r"><code class="sourceCode r">fit</code></pre>
<pre><code>## ETS(A,N,N) 
## 
## Call:
##  forecast::ets(y = anchovy87ts, model = &quot;ANN&quot;) 
## 
##   Smoothing parameters:
##     alpha = 0.7065 
## 
##   Initial states:
##     l = 8.5553 
## 
##   sigma:  0.2166
## 
##       AIC      AICc       BIC 
##  6.764613  7.964613 10.298775</code></pre>
<hr />
</div>
<div id="the-weighting-function" class="section level3">
<h3><span class="header-section-number">4.3.2</span> The weighting function</h3>
<p><img src="Fish-Forecast_files/figure-html/ann.weighting-1.png" width="672" style="display: block; margin: auto;" /></p>
<hr />
</div>
<div id="produce-forecast-using-a-previous-fit" class="section level3">
<h3><span class="header-section-number">4.3.3</span> Produce forecast using a previous fit</h3>
<p>Say you want to estimate a forecasting model from one dataset and use that model to forecast another dataset or another area. Here is how to do that.</p>
<p>This is the fit to the 1964-1987 data:</p>
<pre class="sourceCode r"><code class="sourceCode r">fit1 &lt;-<span class="st"> </span>forecast<span class="op">::</span><span class="kw">ets</span>(anchovy87ts, <span class="dt">model=</span><span class="st">&quot;ANN&quot;</span>)</code></pre>
<p>Use that model with the 2000-2007 data and produce a forecast:</p>
<pre class="sourceCode r"><code class="sourceCode r">dat &lt;-<span class="st"> </span><span class="kw">subset</span>(landings, Species<span class="op">==</span><span class="st">&quot;Anchovy&quot;</span> <span class="op">&amp;</span><span class="st"> </span>Year<span class="op">&gt;=</span><span class="dv">2000</span> <span class="op">&amp;</span><span class="st"> </span>Year<span class="op">&lt;=</span><span class="dv">2007</span>)
dat &lt;-<span class="st"> </span><span class="kw">ts</span>(dat<span class="op">$</span>log.metric.tons, <span class="dt">start=</span><span class="dv">2000</span>)
fit2 &lt;-<span class="st"> </span>forecast<span class="op">::</span><span class="kw">ets</span>(dat, <span class="dt">model=</span>fit1)</code></pre>
<pre><code>## Model is being refit with current smoothing parameters but initial states are being re-estimated.
## Set &#39;use.initial.values=TRUE&#39; if you want to re-use existing initial values.</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">fr2 &lt;-<span class="st"> </span>forecast<span class="op">::</span><span class="kw">forecast</span>(fit2, <span class="dt">h=</span><span class="dv">5</span>)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(fr2)</code></pre>
<p><img src="Fish-Forecast_files/figure-html/unnamed-chunk-35-1.png" width="672" style="display: block; margin: auto;" /></p>
<hr />
</div>
<div id="naive-model-with-drift" class="section level3">
<h3><span class="header-section-number">4.3.4</span> Naive model with drift</h3>
<p>Fit a model that uses the last observation as the forecast but includes a trend estimated from ALL the data. This is what the naive model with drift does.</p>
<pre class="sourceCode r"><code class="sourceCode r">fit.rwf &lt;-<span class="st"> </span>forecast<span class="op">::</span><span class="kw">Arima</span>(anchovy87ts, <span class="dt">order=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>), <span class="dt">include.drift=</span><span class="ot">TRUE</span>)
fr.rwf &lt;-<span class="st"> </span>forecast<span class="op">::</span><span class="kw">forecast</span>(fit.rwf, <span class="dt">h=</span><span class="dv">5</span>)
<span class="kw">plot</span>(fr.rwf)</code></pre>
<p><img src="Fish-Forecast_files/figure-html/unnamed-chunk-36-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>The trend seen in the blue line is estimated from the overall trend in ALL the data.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">coef</span>(fit.rwf)</code></pre>
<pre><code>##      drift 
## 0.06577281</code></pre>
<p>The trend from all the data is (last-first)/(number of steps).</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(<span class="kw">diff</span>(anchovy87ts))</code></pre>
<pre><code>## [1] 0.06577281</code></pre>
<p>So we only use the latest data to choose the level for our forecast but use all the data to choose the trend? It would make more sense to weight the more recent trends more heavily.</p>
<hr />
</div>
<div id="exponential-smoothing-model-with-trend" class="section level3">
<h3><span class="header-section-number">4.3.5</span> Exponential smoothing model with trend</h3>
<p>The exponential smoothing model with trend does this. The one-year trend is
<span class="math display">\[x_t - x_{t-1}\]</span>
That is how much the data increased or decreased.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="kw">diff</span>(anchovy87ts),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="fl">0.3</span>,.<span class="dv">3</span>))
<span class="kw">abline</span>(<span class="dt">h=</span><span class="dv">0</span>, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)
<span class="kw">abline</span>(<span class="dt">h=</span><span class="kw">mean</span>(<span class="kw">diff</span>(anchovy87ts)),<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)
<span class="kw">title</span>(<span class="st">&quot;0 means no change&quot;</span>)</code></pre>
<p><img src="Fish-Forecast_files/figure-html/unnamed-chunk-39-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>If we take the average of all <span class="math inline">\(x_t - x_{t-1}\)</span> we are using the average trend like the naive model with drift. We put an equal weighting on all trends.</p>
<p>But we could use a weighting that falls off exponentially so that we more recent trends affect the forecast more than trends in the distant past. That is what an exponential smoothing model with trend does.</p>
<p><img src="Fish-Forecast_files/figure-html/unnamed-chunk-40-1.png" width="672" style="display: block; margin: auto;" /></p>
<hr />
</div>
<div id="naive-model-with-trend" class="section level3">
<h3><span class="header-section-number">4.3.6</span> Naive model with trend</h3>
<p>If your training data are length <span class="math inline">\(T\)</span>, then a forecast for <span class="math inline">\(T+h\)</span> is</p>
<p><span class="math display">\[\hat{x}_{T+h} = l_T + h \bar{b}\]</span></p>
<p>where <span class="math inline">\(\hat{b}\)</span> is the mean of the the yearly changes in <span class="math inline">\(x\)</span>, so the mean of <span class="math inline">\(x_t - x_{t-1}\)</span>.</p>
<p><span class="math display">\[\hat{b} = \sum_{t=2}^T (x_t - x_{t-1})\]</span></p>
</div>
<div id="exponential-smoothing-model-with-trend-1" class="section level3">
<h3><span class="header-section-number">4.3.7</span> Exponential smoothing model with trend</h3>
<p><span class="math display">\[\hat{x}_{T+h} = l_T + h b_T\]</span></p>
<p>where <span class="math inline">\(b_T\)</span> is a weighted average with the more recent trends given more weight.</p>
<p><span class="math display">\[b_t = \sum_{t=2}^T \beta (1-\beta)^{t-2}(x_t - x_{t-1})\]</span></p>
<div id="fit-exponential-smoothing-with-trend" class="section level4 unnumbered">
<h4>Fit exponential smoothing with trend</h4>
<pre class="sourceCode r"><code class="sourceCode r">fit &lt;-<span class="st"> </span>forecast<span class="op">::</span><span class="kw">ets</span>(anchovy87ts, <span class="dt">model=</span><span class="st">&quot;AAN&quot;</span>)
fr &lt;-<span class="st"> </span>forecast<span class="op">::</span><span class="kw">forecast</span>(fit, <span class="dt">h=</span><span class="dv">5</span>)
<span class="kw">plot</span>(fr)</code></pre>
<p><img src="Fish-Forecast_files/figure-html/unnamed-chunk-41-1.png" width="672" style="display: block; margin: auto;" /></p>
<hr />
</div>
</div>
<div id="decomposing-your-model-fit" class="section level3">
<h3><span class="header-section-number">4.3.8</span> Decomposing your model fit</h3>
<p>Sometimes you would like to see the smoothed level and smoothed trend that the model estimated. You can see that with <code>plot(fit)</code> or <code>autoplot(fit)</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">autoplot</span>(fit)</code></pre>
<p><img src="Fish-Forecast_files/figure-html/unnamed-chunk-42-1.png" width="672" style="display: block; margin: auto;" /></p>
<hr />
</div>
<div id="forecast-performance" class="section level3">
<h3><span class="header-section-number">4.3.9</span> Forecast performance</h3>
<p>We can evaluate the forecast performance with forecasts of our test data or we can use all the data and use time-series cross-validation.</p>
<p>Let’s start with the former.</p>
<hr />
</div>
<div id="test-forecast-performance" class="section level3">
<h3><span class="header-section-number">4.3.10</span> Test forecast performance</h3>
<div id="test-against-a-test-data-set" class="section level4 unnumbered">
<h4>Test against a test data set</h4>
<p>We will fit an an exponential smoothing model with trend to the training data and make a forecast for the years that we ‘held out’.</p>
<pre class="sourceCode r"><code class="sourceCode r">fit1 &lt;-<span class="st"> </span>forecast<span class="op">::</span><span class="kw">ets</span>(traindat, <span class="dt">model=</span><span class="st">&quot;AAN&quot;</span>)
h=<span class="kw">length</span>(testdat)
fr &lt;-<span class="st"> </span>forecast<span class="op">::</span><span class="kw">forecast</span>(fit1, <span class="dt">h=</span>h)
<span class="kw">plot</span>(fr)
<span class="kw">points</span>(<span class="kw">length</span>(traindat)<span class="op">+</span><span class="dv">1</span><span class="op">:</span>h, testdat, <span class="dt">pch=</span><span class="dv">2</span>, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>)
<span class="kw">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;forecast&quot;</span>,<span class="st">&quot;actual&quot;</span>), <span class="dt">pch=</span><span class="kw">c</span>(<span class="dv">20</span>,<span class="dv">2</span>), <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;red&quot;</span>))</code></pre>
<p><img src="Fish-Forecast_files/figure-html/unnamed-chunk-44-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>We can calculate a variety of forecast error metrics with</p>
<pre class="sourceCode r"><code class="sourceCode r">forecast<span class="op">::</span><span class="kw">accuracy</span>(fr, testdat)</code></pre>
<pre><code>##                      ME      RMSE       MAE        MPE     MAPE      MASE
## Training set  0.0155561 0.1788989 0.1442712  0.1272938 1.600532 0.7720807
## Test set     -0.5001701 0.5384355 0.5001701 -5.1678506 5.167851 2.6767060
##                      ACF1
## Training set -0.008371542
## Test set               NA</code></pre>
<p>We would now repeat this for all the models in our candidate set and choose the model with the best forecast performance.</p>
</div>
<div id="test-using-time-series-cross-validation" class="section level4 unnumbered">
<h4>Test using time-series cross-validation</h4>
<p>Another approach is to use all the data and test a series of forecasts made by fitting the model to different lengths of the data.</p>
<p>In this approach, we don’t have test data. Instead we will use all the data for fitting and for forecast testing.</p>
<p>We will redefine <code>traindat</code> as all our Anchovy data.</p>
</div>
<div id="tscv-function" class="section level4 unnumbered">
<h4>tsCV() function</h4>
<p>We will use the <code>tsCV()</code> function. We need to define a function that returns a forecast.</p>
<pre class="sourceCode r"><code class="sourceCode r">far2 &lt;-<span class="st"> </span><span class="cf">function</span>(x, h, model){
  fit &lt;-<span class="st"> </span><span class="kw">ets</span>(x, <span class="dt">model=</span>model)
  <span class="kw">forecast</span>(fit, <span class="dt">h=</span>h)
  }</code></pre>
<p>Now we can use <code>tsCV()</code> to run our <code>far2()</code> function to a series of training data sets. We will specify that a NEW ets model be estimated for each training set. We are not using the weighting estimated for the whole data set but estimating the weighting new for each set.</p>
<p>The <code>e</code> are our forecast errors for all the forecasts that we did with the data.</p>
<pre class="sourceCode r"><code class="sourceCode r">e &lt;-<span class="st"> </span>forecast<span class="op">::</span><span class="kw">tsCV</span>(traindat, far2, <span class="dt">h=</span><span class="dv">1</span>, <span class="dt">model=</span><span class="st">&quot;AAN&quot;</span>)
e</code></pre>
<pre><code>## Time Series:
## Start = 1 
## End = 26 
## Frequency = 1 
##  [1] -0.245378390  0.366852341  0.419678595 -0.414861770 -0.152727933
##  [6] -0.183775208 -0.013799590  0.308433377 -0.017680471 -0.329690537
## [11] -0.353441463  0.266143346 -0.110848616 -0.005227309  0.157821831
## [16]  0.196184446  0.008135667  0.326024067  0.085160559  0.312668447
## [21]  0.246437781  0.117274740  0.292601670 -0.300814605 -0.406118961
## [26]           NA</code></pre>
<p>Let’s look at the first few <code>e</code> so we see exactly with <code>tsCV()</code> is doing.</p>
<pre class="sourceCode r"><code class="sourceCode r">e[<span class="dv">2</span>]</code></pre>
<pre><code>## [1] 0.3668523</code></pre>
<p>This uses training data from <span class="math inline">\(t=1\)</span> to <span class="math inline">\(t=2\)</span> so fits an ets to the first two data points alone. Then it creates a forecast for <span class="math inline">\(t=3\)</span> and compares that forecast to the actual value observed for <span class="math inline">\(t=3\)</span>.</p>
<pre class="sourceCode r"><code class="sourceCode r">TT &lt;-<span class="st"> </span><span class="dv">2</span> <span class="co"># end of the temp training data</span>
temp &lt;-<span class="st"> </span>traindat[<span class="dv">1</span><span class="op">:</span>TT]
fit.temp &lt;-<span class="st"> </span>forecast<span class="op">::</span><span class="kw">ets</span>(temp, <span class="dt">model=</span><span class="st">&quot;AAN&quot;</span>)
fr.temp &lt;-<span class="st"> </span>forecast<span class="op">::</span><span class="kw">forecast</span>(fit.temp, <span class="dt">h=</span><span class="dv">1</span>)
traindat[TT<span class="op">+</span><span class="dv">1</span>] <span class="op">-</span><span class="st"> </span>fr.temp<span class="op">$</span>mean</code></pre>
<pre><code>## Time Series:
## Start = 3 
## End = 3 
## Frequency = 1 
## [1] 0.3668523</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">e[<span class="dv">3</span>]</code></pre>
<pre><code>## [1] 0.4196786</code></pre>
<p>This uses training data from <span class="math inline">\(t=1\)</span> to <span class="math inline">\(t=2\)</span> so fits an ets to the first two data points alone. Then it creates a forecast for <span class="math inline">\(t=3\)</span> and compares that forecast to the actual value observed for <span class="math inline">\(t=3\)</span>.</p>
<pre class="sourceCode r"><code class="sourceCode r">TT &lt;-<span class="st"> </span><span class="dv">3</span> <span class="co"># end of the temp training data</span>
temp &lt;-<span class="st"> </span>traindat[<span class="dv">1</span><span class="op">:</span>TT]
fit.temp &lt;-<span class="st"> </span>forecast<span class="op">::</span><span class="kw">ets</span>(temp, <span class="dt">model=</span><span class="st">&quot;AAN&quot;</span>)
fr.temp &lt;-<span class="st"> </span>forecast<span class="op">::</span><span class="kw">forecast</span>(fit.temp, <span class="dt">h=</span><span class="dv">1</span>)
traindat[TT<span class="op">+</span><span class="dv">1</span>] <span class="op">-</span><span class="st"> </span>fr.temp<span class="op">$</span>mean</code></pre>
<pre><code>## Time Series:
## Start = 4 
## End = 4 
## Frequency = 1 
## [1] 0.4196786</code></pre>
<hr />
</div>
</div>
<div id="testing-a-specific-ets-model" class="section level3">
<h3><span class="header-section-number">4.3.11</span> Testing a specific ets model</h3>
<p>By specifying <code>model=&quot;AAN&quot;</code>, we estimated a new ets model (meaning new weighting) for each training set used. We might want to specify that we use only the weighting we estimated for the full data set.</p>
<p>We do this by passing in a fit to <code>model</code>.</p>
<p>The <code>e</code> are our forecast errors for all the forecasts that we did with the data. <code>fit1</code> below is the ets estimated from all the data 1964 to 1989. Note, the code will produce a warning that it is estimating the initial value and just using the weighting. That is what we want.</p>
<pre class="sourceCode r"><code class="sourceCode r">fit1 &lt;-<span class="st"> </span>forecast<span class="op">::</span><span class="kw">ets</span>(traindat, <span class="dt">model=</span><span class="st">&quot;AAN&quot;</span>)
e &lt;-<span class="st"> </span>forecast<span class="op">::</span><span class="kw">tsCV</span>(traindat, far2, <span class="dt">h=</span><span class="dv">1</span>, <span class="dt">model=</span>fit1)
e</code></pre>
<pre><code>## Time Series:
## Start = 1 
## End = 26 
## Frequency = 1 
##  [1]           NA  0.576663901  1.031385937  0.897828249  1.033164616
##  [6]  0.935274283  0.958914499  1.265427119 -0.017241938 -0.332751184
## [11] -0.330473144  0.255886314 -0.103926617  0.031206730  0.154727479
## [16]  0.198328366 -0.020605522  0.297475742  0.005297401  0.264939892
## [21]  0.196256334  0.129798648  0.335887872 -0.074017535 -0.373267163
## [26]           NA</code></pre>
<hr />
</div>
<div id="forecast-accuracy-metrics" class="section level3">
<h3><span class="header-section-number">4.3.12</span> Forecast accuracy metrics</h3>
<p>Now we can compute forecast accuracy metrics from the forecast errors (<code>e</code>).</p>
<p>RMSE: root mean squared error</p>
<pre class="sourceCode r"><code class="sourceCode r">rmse &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">mean</span>(e<span class="op">^</span><span class="dv">2</span>, <span class="dt">na.rm=</span><span class="ot">TRUE</span>))</code></pre>
<p>MAE: mean absolute error</p>
<pre class="sourceCode r"><code class="sourceCode r">mae &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">abs</span>(e), <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</code></pre>

</div>
</div>
<!-- </div> -->
            </section>

          </div>
        </div>
      </div>
<a href="4-2-simple-ets.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="5-testing-forecast-accuracy.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/fish-forecast/Fish-Forecast-Bookdown/edit/master/Forecasting-4-1-Exp-Smoothing.Rmd",
"text": "Edit"
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
