## Simple ETS

Simple exponential smoothing uses this type of weighting that falls off exponentially and the objective to estimate the best weighting ( $\alpha$ ):

```{r echo=FALSE}
alpha <- 1
wts <- alpha*(1-alpha)^(0:23)
plot(1987:1964, wts/sum(wts), lwd=2, ylab="weight", xlab="", type="l")
alpha <- 0.5
wts <- alpha*(1-alpha)^(0:23)
lines(1987:1964, wts/sum(wts), lwd=2, col="blue")
alpha <- 0.05
wts <- alpha*(1-alpha)^(0:23)
lines(1987:1964, wts/sum(wts), lwd=2, col="red")
legend("topleft", c("alpha=1 like naive","alpha=0.5","alpha=0.05 like mean"),lwd=2, col=c("black","blue","red"))
title("more weight put on more recent values\nfor 1988 forecast")
```

## Fitting with `ets()`

The forecast package will fit a wide variety of exponential smoothing models.  The main fitting function is `ets()`:

```
ets(y, model = "ZZZ", < + many other arguments >)
```

* y : your data.  A time series of responses.

* model: what type of exponential smoothing model.


We are going to use `ets()` to fit three simple types of exponential smoothing models:

model  | "ZZZ" | alternate function |
------------- | ------------- | --------- |
exponential smoothing no trend | "ANN" | `ses()` |
exponential smoothing with trend  | "AAN" | `holt()` |
exponential smoothing choose trend  | "AZN" | NA |

The alternate function does exactly the same fitting.  It is just a 'shortcut'.

---

### Exponential smoothing with no trend

This is like the naive model that just uses the last value to make the forecast, but instead of only using the last value it will use values farther in the past also. The weighting fall off exponentially.

Load the data and forecast package.

```{r load_data_exp_smoothing}
load("landings.RData")
```

```{r fit.ann}
fit <- forecast::ets(anchovy87ts, model="ANN")
fr <- forecast::forecast(fit, h=5)
```

---

```{r}
plot(fr)
```


Look at the estimates

```{r}
fit
```

---

### The weighting function

```{r ann.weighting, echo=FALSE}
alpha <- coef(fit)[1]
wts <- alpha*(1-alpha)^(0:23)
plot(1987:1964, wts/sum(wts), lwd=2, ylab="weight", xlab="", type="l")
title("Weighting for simple exp. smooth of anchovy")
```

---

### Produce forecast using a previous fit

Say you want to estimate a forecasting model from one dataset and use that model to forecast another dataset or another area.  Here is how to do that.

This is the fit to the 1964-1987 data:

```{r}
fit1 <- forecast::ets(anchovy87ts, model="ANN")
```

Use that model with the 2000-2007 data and produce a forecast:

```{r fit.new.ann}
dat <- subset(landings, Species=="Anchovy" & Year>=2000 & Year<=2007)
dat <- ts(dat$log.metric.tons, start=2000)
fit2 <- forecast::ets(dat, model=fit1)
fr2 <- forecast::forecast(fit2, h=5)
```


```{r}
plot(fr2)
```

---

### Decomposing your model fit

Sometimes you would like to see the smoothed level and smoothed trend that the model estimated. You can see that with `plot(fit)` or `autoplot(fit)`.

```{r fig.height=4}
autoplot(fit)
```


